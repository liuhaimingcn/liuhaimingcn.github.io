<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="寻梦的尕柳的个人blog"><meta name="keywords" content="编程, java, node.js, 摄影"><title>RPC框架motan使用 | 寻梦的尕柳</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.3.0"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=1.3.0"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">RPC框架motan使用</h1><a id="logo" href="/.">寻梦的尕柳</a><p class="description">幽幽一缕香，飘在深深旧梦中，宛如挥手袖底风，淡淡回首，也无风雨也无晴。</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">RPC框架motan使用</h1><div class="post-meta">Nov 10, 2016<span> | </span><span class="category"><a href="/categories/RPC/">RPC</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/11/10/RPC/motan-hello/" href="/2016/11/10/RPC/motan-hello/#comments" class="ds-thread-count"></a><div class="post-content"><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul>
<li>motan是新浪微博开源的一套轻量级、方便使用的RPC框架</li>
<li>项目地址：<a href="https://github.com/weibocom/motan" target="_blank" rel="external">https://github.com/weibocom/motan</a></li>
</ul>
<a id="more"></a>
<h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><ul>
<li>使用的过程分为Server端和Client端，Server提供RCP的服务接口，Client端发起调用获取结果。</li>
<li>maven的pom文件配置  </li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">motan.version</span>&gt;</span>0.2.1<span class="tag">&lt;/<span class="name">motan.version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.weibo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>motan-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;motan.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.weibo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>motan-transport-netty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;motan.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.weibo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>motan-springsupport<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;motan.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="Server-端"><a href="#Server-端" class="headerlink" title="Server 端"></a>Server 端</h3><ul>
<li><p>暴露的接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.raventech.user.motan;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HelloService</span> </span>&#123;</div><div class="line">  <span class="function">String <span class="title">hello</span><span class="params">(String world)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>暴露接口的实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.raventech.user.motan;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServiceImpl</span> <span class="keyword">implements</span> <span class="title">HelloService</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(String world)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"hello "</span> + world;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>xml配置文件，暴露接口</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xmlns:motan</span>=<span class="string">"http://api.weibo.com/schema/motan"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></div><div class="line">        http://api.weibo.com/schema/motan http://api.weibo.com/schema/motan.xsd"&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloServiceImpl"</span> <span class="attr">class</span>=<span class="string">"com.raventech.user.motan.HelloServiceImpl"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">motan:service</span> <span class="attr">interface</span>=<span class="string">"com.raventech.user.motan.HelloService"</span> <span class="attr">ref</span>=<span class="string">"helloServiceImpl"</span> <span class="attr">export</span>=<span class="string">"8002"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>启动服务的方法（运行main方法就可以启动服务了）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.raventech.user;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:motan-server.xml"</span>);</div><div class="line">    System.out.println(<span class="string">"Server start ..."</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Client-端"><a href="#Client-端" class="headerlink" title="Client 端"></a>Client 端</h3><ul>
<li><p>要请求的接口（不论包名还是类名都要和Server端的一样）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.raventech.user.motan;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HelloService</span> </span>&#123;</div><div class="line">  <span class="function">String <span class="title">hello</span><span class="params">(String world)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>xml配置文件，获取接口信息</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xmlns:motan</span>=<span class="string">"http://api.weibo.com/schema/motan"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></div><div class="line">        http://api.weibo.com/schema/motan http://api.weibo.com/schema/motan.xsd"&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">motan:referer</span> <span class="attr">id</span>=<span class="string">"helloService"</span> <span class="attr">interface</span>=<span class="string">"com.raventech.user.motan.HelloService"</span> <span class="attr">directUrl</span>=<span class="string">"127.0.0.1:8002"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>调用服务的方法（运行main方法就可以调用服务了）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.raventech.web;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.raventech.user.motan.HelloService;</div><div class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</div><div class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:motan-client.xml"</span>);</div><div class="line">    HelloService fooService = (HelloService) applicationContext.getBean(<span class="string">"helloService"</span>);</div><div class="line">    System.out.println(fooService.hello(<span class="string">"world"</span>));</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>调用响应结果<br><img src="http://7xia33.com1.z0.glb.clouddn.com/2016-11-09%20at%2017.45.png" alt=""></p>
</li>
</ul>
<h2 id="使用Consul作为注册中心"><a href="#使用Consul作为注册中心" class="headerlink" title="使用Consul作为注册中心"></a>使用Consul作为注册中心</h2><ul>
<li>在集群环境下使用motan需要依赖Consul等服务发现组件</li>
<li><a href="https://www.google.com" target="_blank" rel="external">Consul的介绍安装和使用</a></li>
<li>maven的pom文件配置(在上面的基础上增加consul)<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.weibo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>motan-registry-consul<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;motan.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Server-端-1"><a href="#Server-端-1" class="headerlink" title="Server 端"></a>Server 端</h3><ul>
<li><p>xml配置文件添加consul的注册</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xmlns:motan</span>=<span class="string">"http://api.weibo.com/schema/motan"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></div><div class="line">        http://api.weibo.com/schema/motan http://api.weibo.com/schema/motan.xsd"&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">motan:registry</span> <span class="attr">regProtocol</span>=<span class="string">"consul"</span> <span class="attr">name</span>=<span class="string">"registry"</span> <span class="attr">address</span>=<span class="string">"127.0.0.1:8500"</span>/&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloServiceImpl"</span> <span class="attr">class</span>=<span class="string">"com.raventech.user.motan.HelloServiceImpl"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">motan:service</span> <span class="attr">interface</span>=<span class="string">"com.raventech.user.motan.HelloService"</span> <span class="attr">ref</span>=<span class="string">"helloServiceImpl"</span> <span class="attr">registry</span>=<span class="string">"registry"</span>  <span class="attr">export</span>=<span class="string">"8002"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>启动服务的方法要在程序启动后调用心跳开关，将服务注册到consul，不然Client无法调用 （别的和上文Hello World一样不变，运行main方法启动服务）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.raventech.user;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.weibo.api.motan.common.MotanConstants;</div><div class="line"><span class="keyword">import</span> com.weibo.api.motan.util.MotanSwitcherUtil;</div><div class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:motan-server.xml"</span>);</div><div class="line">    MotanSwitcherUtil.setSwitcherValue(MotanConstants.REGISTRY_HEARTBEAT_SWITCHER, <span class="keyword">true</span>);</div><div class="line">    System.out.println(<span class="string">"Server start ..."</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Client-端-1"><a href="#Client-端-1" class="headerlink" title="Client 端"></a>Client 端</h3><ul>
<li><p>xml配置文件添加consul的服务发现</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       <span class="attr">xmlns:motan</span>=<span class="string">"http://api.weibo.com/schema/motan"</span></div><div class="line">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></div><div class="line">        http://api.weibo.com/schema/motan http://api.weibo.com/schema/motan.xsd"&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">motan:registry</span> <span class="attr">regProtocol</span>=<span class="string">"consul"</span> <span class="attr">name</span>=<span class="string">"registry"</span> <span class="attr">address</span>=<span class="string">"127.0.0.1:8500"</span>/&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">motan:referer</span> <span class="attr">id</span>=<span class="string">"helloService"</span> <span class="attr">interface</span>=<span class="string">"com.raventech.user.motan.HelloService"</span> <span class="attr">registry</span>=<span class="string">"registry"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>别的和上文Hello World一样不变，运行Client类的main方法调用服务</p>
</li>
</ul>
<h2 id="使用注解的方式集成到Spring-Boot项目中"><a href="#使用注解的方式集成到Spring-Boot项目中" class="headerlink" title="使用注解的方式集成到Spring Boot项目中"></a>使用注解的方式集成到Spring Boot项目中</h2><ul>
<li>项目改成Spring Boot后抛弃了繁琐的xml文件配置改为用注解的方式。motan也支持注解的方式进行配置，这样更加方便了代码的集成和风格的统一。</li>
<li>继续在前面的代码中进行修改，没提到的保持不变</li>
</ul>
<h3 id="Server-端-2"><a href="#Server-端-2" class="headerlink" title="Server 端"></a>Server 端</h3><ul>
<li>删除motan-server.xml配置文件</li>
<li><p>用注解加载motan需要的配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.raventech.user.config;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.weibo.api.motan.config.springsupport.AnnotationBean;</div><div class="line"><span class="keyword">import</span> com.weibo.api.motan.config.springsupport.BasicServiceConfigBean;</div><div class="line"><span class="keyword">import</span> com.weibo.api.motan.config.springsupport.ProtocolConfigBean;</div><div class="line"><span class="keyword">import</span> com.weibo.api.motan.config.springsupport.RegistryConfigBean;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MotanConfiguration</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="meta">@Bean</span></div><div class="line">  <span class="function"><span class="keyword">public</span> AnnotationBean <span class="title">motanAnnotationBean</span><span class="params">()</span> </span>&#123;</div><div class="line">    AnnotationBean motanAnnotationBean = <span class="keyword">new</span> AnnotationBean();</div><div class="line">    motanAnnotationBean.setPackage(<span class="string">"com.raventech.user.motan"</span>);</div><div class="line">    <span class="keyword">return</span> motanAnnotationBean;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="meta">@Bean</span>(name = <span class="string">"motan"</span>)</div><div class="line">  <span class="function"><span class="keyword">public</span> ProtocolConfigBean <span class="title">protocolConfig1</span><span class="params">()</span> </span>&#123;</div><div class="line">    ProtocolConfigBean config = <span class="keyword">new</span> ProtocolConfigBean();</div><div class="line">    config.setDefault(<span class="keyword">true</span>);</div><div class="line">    config.setName(<span class="string">"motan"</span>);</div><div class="line">    config.setMaxContentLength(<span class="number">1048576</span>);</div><div class="line">    <span class="keyword">return</span> config;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="meta">@Bean</span>(name = <span class="string">"registry"</span>)</div><div class="line">  <span class="function"><span class="keyword">public</span> RegistryConfigBean <span class="title">registryConfig</span><span class="params">()</span> </span>&#123;</div><div class="line">    RegistryConfigBean config = <span class="keyword">new</span> RegistryConfigBean();</div><div class="line">    config.setRegProtocol(<span class="string">"consul"</span>);</div><div class="line">    config.setAddress(<span class="string">"127.0.0.1:8500"</span>);</div><div class="line">    <span class="keyword">return</span> config;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="meta">@Bean</span></div><div class="line">  <span class="function"><span class="keyword">public</span> BasicServiceConfigBean <span class="title">baseServiceConfig</span><span class="params">()</span> </span>&#123;</div><div class="line">    BasicServiceConfigBean config = <span class="keyword">new</span> BasicServiceConfigBean();</div><div class="line">    config.setExport(<span class="string">"motan:8002"</span>);</div><div class="line">    config.setRegistry(<span class="string">"registry"</span>);</div><div class="line">    <span class="keyword">return</span> config;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>暴露接口的实现类加上@MotanService注解，自动生成bean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.raventech.user.motan;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.weibo.api.motan.config.springsupport.annotation.MotanService;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line"><span class="meta">@MotanService</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServiceImpl</span> <span class="keyword">implements</span> <span class="title">HelloService</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(String world)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"hello "</span> + world;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>启动服务的方法就是启动Spring Boot项目，并在在程序启动后调用心跳开关 (运行main方法启动服务)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.raventech.user;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.weibo.api.motan.common.MotanConstants;</div><div class="line"><span class="keyword">import</span> com.weibo.api.motan.util.MotanSwitcherUtil;</div><div class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</div><div class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line"><span class="meta">@SpringBootApplication</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    SpringApplication.run(Server.class, args);</div><div class="line">    MotanSwitcherUtil.setSwitcherValue(MotanConstants.REGISTRY_HEARTBEAT_SWITCHER, <span class="keyword">true</span>);</div><div class="line">    System.out.println(<span class="string">"Server start ..."</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Client-端-2"><a href="#Client-端-2" class="headerlink" title="Client 端"></a>Client 端</h3><ul>
<li>删除motan-client.xml配置文件和Client.java启动文件，已经没用了</li>
<li><p>用注解加载motan需要的配置</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">package com.raventech.web.config;</div><div class="line"></div><div class="line">import com.weibo.api.motan.config.springsupport.AnnotationBean;</div><div class="line">import com.weibo.api.motan.config.springsupport.BasicRefererConfigBean;</div><div class="line">import com.weibo.api.motan.config.springsupport.ProtocolConfigBean;</div><div class="line">import com.weibo.api.motan.config.springsupport.RegistryConfigBean;</div><div class="line">import org.springframework.context.annotation.Bean;</div><div class="line">import org.springframework.context.annotation.Configuration;</div><div class="line"></div><div class="line">/**</div><div class="line"> * @author liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line">@Configuration</div><div class="line">public class MotanConfiguration &#123;</div><div class="line"></div><div class="line">  @Bean</div><div class="line">  public AnnotationBean motanAnnotationBean() &#123;</div><div class="line">    AnnotationBean motanAnnotationBean = new AnnotationBean();</div><div class="line">    # 添加用到motan注解的类的包名</div><div class="line">    motanAnnotationBean.setPackage("com.raventech.web.controller");</div><div class="line">    return motanAnnotationBean;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  @Bean(name = "motan")</div><div class="line">  public ProtocolConfigBean protocolConfig1() &#123;</div><div class="line">    ProtocolConfigBean config = new ProtocolConfigBean();</div><div class="line">    config.setDefault(true);</div><div class="line">    config.setName("motan");</div><div class="line">    config.setMaxContentLength(1048576);</div><div class="line">    return config;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  @Bean(name = "registry")</div><div class="line">  public RegistryConfigBean registryConfig() &#123;</div><div class="line">    RegistryConfigBean config = new RegistryConfigBean();</div><div class="line">    config.setRegProtocol("consul");</div><div class="line">    config.setAddress("127.0.0.1:8500");</div><div class="line">    return config;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  @Bean(name = "basicRefererConfig")</div><div class="line">  public BasicRefererConfigBean basicRefererConfigBean() &#123;</div><div class="line">    BasicRefererConfigBean config = new BasicRefererConfigBean();</div><div class="line">    config.setProtocol("motan");</div><div class="line">    config.setRegistry("registry");</div><div class="line">    config.setThrowException(true);</div><div class="line">    return config;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>调用方法（在Controller中使用）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.raventech.web.controller;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.raventech.user.motan.HelloService;</div><div class="line"><span class="keyword">import</span> com.raventech.web.common.BaseController;</div><div class="line"><span class="keyword">import</span> com.weibo.api.motan.config.springsupport.annotation.MotanReferer;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> liuhaiming on 10/11/2016.</div><div class="line"> */</div><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/motan"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">BaseController</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="meta">@MotanReferer</span>(basicReferer = <span class="string">"basicRefererConfig"</span>)</div><div class="line">  <span class="keyword">private</span> HelloService helloService;</div><div class="line"></div><div class="line">  <span class="meta">@RequestMapping</span>(value = <span class="string">"/hello"</span>, method = RequestMethod.GET)</div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="keyword">return</span> helloService.hello(<span class="string">"world"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>启动Spring Boot项目，在浏览器中访问<a href="http://127.0.0.1:8080/motan/hello就可以获取验证结果" target="_blank" rel="external">http://127.0.0.1:8080/motan/hello就可以获取验证结果</a></p>
</li>
</ul>
<p><br></p>
</div><div class="tags"><a href="/tags/original/">original</a><a href="/tags/motan/">motan</a></div><div class="post-nav"><a href="/2016/12/06/Java/jvm/" class="pre">深入理解 Java 虚拟机笔记</a><a href="/2016/11/04/Architecture/elk/" class="next">使用ELK管理日志</a></div><div data-thread-key="2016/11/10/RPC/motan-hello/" data-title="RPC框架motan使用" data-url="http://haiyue.me/2016/11/10/RPC/motan-hello/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到:</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div id="comments"><div data-thread-key="2016/11/10/RPC/motan-hello/" data-title="RPC框架motan使用" data-url="http://haiyue.me/2016/11/10/RPC/motan-hello/" data-author-key="1" class="ds-thread"></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="widget"><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="请输入关键字..."/></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Architecture/">Architecture</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/">Node.js</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Photo/">Photo</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/RPC/">RPC</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot/">Spring Boot</a><span class="category-list-count">4</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/note/" style="font-size: 15px;">note</a> <a href="/tags/es6/" style="font-size: 15px;">es6</a> <a href="/tags/original/" style="font-size: 15px;">original</a> <a href="/tags/jvm/" style="font-size: 15px;">jvm</a> <a href="/tags/软件/" style="font-size: 15px;">软件</a> <a href="/tags/motan/" style="font-size: 15px;">motan</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="http://godmod.cn" title="GodMod" target="_blank">GodMod</a></div><div class="widget"><div class="widget-title"><i class="fa fa-weibo"> 新浪微博</i></div><iframe width="100%" height="400" frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&amp;width=0&amp;height=400&amp;fansRow=1&amp;ptype=1&amp;speed=0&amp;skin=5&amp;isTitle=0&amp;noborder=1&amp;isWeibo=1&amp;isFans=0&amp;uid=1819387822&amp;verifier=3b3e0dc8&amp;dpc=1" class="share_self"></iframe></div><div class="widget"><div class="comments-title"><i class="fa fa-commt"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/04/05/Linux/dns-records/">DNS Records 名词解释</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/05/Java/volatile/">理解 volatile</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/27/Linux/linux-kernel/">Linux调优</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/21/Architecture/jenkins/">使用jenkins进行项目的自动构建部署</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/16/JavaScript/尾调用优化/">尾调用优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/06/Java/jvm/">深入理解 Java 虚拟机笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/10/RPC/motan-hello/">RPC框架motan使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/04/Architecture/elk/">使用ELK管理日志</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/27/SpringBoot/spring-boot-jedis/">Spring Boot 中使用 Jedis 来操作 Redis</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/SpringBoot/spring-boot-no-beans/">Configuration 注解中使用 Autowired 注解 IDE 报错</a></li></ul></div></div></div></div><a id="totop" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.3.0" async></script><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |<a href="/atom.xml">订阅本站</a> |<span>联系博主：<a href="mailto:liuhaiming.cn@gmail.com" target="_blank" class="fa fa-email"> </a><a href="http://weibo.com/luobuxiadeyu" target="_blank" class="fa fa-weibo"></a><a href="https://github.com/liuhaimingcn" target="_blank" class="fa fa-github"> </a></span></p><p><span> Copyright &copy;<a href="/." rel="nofollow">寻梦的尕柳</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span><span><a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> Theme </a>by<a rel="nofollow" target="_blank" href="https://github.com/chaooo"> Charles.</a></span></p></div></div></div><script>var duoshuoQuery = {short_name:'liuhaiming'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    document.getElementsByTagName('body')[0].appendChild(ds);
})();
</script><script type="text/javascript" src="/js/search.json.js?v=1.3.0"></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?a7a2c4aca1cbfe4dd193dcc93b9b2012";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script></body></html>